<!-- test-fetch-menus.html -->
<div class="content-container">
  <h2>メニュー一覧（テスト）</h2>
  <table id="menuTable">
    <thead>
      <tr>
        <th>表示名</th>
        <th>リンク先HTML</th>
        <th>順番</th>
        <th>公開</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<script type="module">
  import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm'

  const supabaseUrl = 'https://viihcgkjzzhkdiwdzdex.supabase.co'
  const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZpaWhjZ2tqenpoa2Rpd2R6ZGV4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTIxMzUwNDksImV4cCI6MjAyNzAxMTA0OX0.0jjcgZ_EH7Ek8MBwCvgtatg1-lDFpNuFRHh14iPYjJU'
  const supabase = createClient(supabaseUrl, supabaseKey)

  const tableBody = document.querySelector('#menuTable tbody')

  async function fetchMenus() {
    const { data, error } = await supabase
      .from('admin_menus')
      .select('*')
      .order('sort_order')

    if (error) {
      console.error('読み込みエラー:', error)
      tableBody.innerHTML = `<tr><td colspan="4">読み込み失敗: ${error.message}</td></tr>`
      return
    }

    if (data.length === 0) {
      tableBody.innerHTML = '<tr><td colspan="4">データがありません</td></tr>'
      return
    }

    data.forEach(menu => {
      const row = document.createElement('tr')
      row.innerHTML = `
        <td>${menu.title}</td>
        <td>${menu.filename}</td>
        <td>${menu.sort_order}</td>
        <td>${menu.is_active ? '✔' : ''}</td>
      `
      tableBody.appendChild(row)
    })
  }

  fetchMenus()
</script>

<style>
  .content-container {
    padding: 20px;
    font-family: sans-serif;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 16px;
  }
  th, td {
    padding: 10px;
    border: 1px solid #ccc;
  }
  th {
    background-color: #f4f4f4;
  }
</style>
