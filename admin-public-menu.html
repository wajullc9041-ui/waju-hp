<!-- ===== 管理：ヘッダー＆フッター設定 + メニュー管理 (hf_settings対応) ===== -->

<div id="hf-admin-root">
  <h2>ヘッダー & フッター 管理</h2>

  <!-- ================= ヘッダー：プレビュー ================= -->
  <section class="panel">
    <div class="panel-head">
      <h3>ヘッダー プレビュー</h3>
      <div class="actions">
        <button id="saveHeaderBtn" class="btn primary">ヘッダー設定を保存</button>
      </div>
    </div>
    <div id="headerPreview" class="preview-surface"></div>

    <!-- ===== ヘッダー：編集パネル ===== -->
    <div class="edit-grid">
      <div class="field"><label>会社名</label><input type="text" id="company_name" /></div>
      <div class="field"><label>ロゴURL</label><input type="text" id="logo_url" /></div>
      <div class="field"><label>ロゴ高さ(px)</label><input type="number" id="logo_height" /></div>
      <div class="field"><label>ロゴ位置</label><select id="logo_alignment"><option>left</option><option>center</option><option>right</option></select></div>
      <div class="field"><label>会社名位置</label><select id="company_alignment"><option>left</option><option>center</option><option>right</option></select></div>
      <div class="field"><label>ナビ位置</label><select id="nav_alignment"><option>left</option><option>center</option><option>right</option></select></div>
      <div class="field"><label>背景色</label><input type="color" id="header_bg_color" /></div>
      <div class="field"><label>背景グラデーション</label><input type="text" id="header_bg_gradient" placeholder="linear-gradient(...)" /></div>
      <div class="field"><label>文字色</label><input type="color" id="header_text_color" /></div>
      <div class="field"><label>フォント</label><input type="text" id="header_font_family" placeholder="Noto Sans JP, sans-serif" /></div>
      <div class="field"><label>文字サイズ(px)</label><input type="number" id="header_font_size" /></div>
      <div class="field"><label>文字太さ</label><select id="header_font_weight"><option>normal</option><option>bold</option></select></div>
      <div class="field"><label>リンク間隔(px)</label><input type="number" id="header_link_spacing" /></div>
      <div class="field col2"><label>パディング</label><input type="text" id="header_padding" /></div>
    </div>
  </section>

  <!-- ================= フッター：プレビュー ================= -->
  <section class="panel">
    <div class="panel-head">
      <h3>フッター プレビュー</h3>
      <div class="actions">
        <button id="saveFooterBtn" class="btn primary">フッター設定を保存</button>
      </div>
    </div>
    <div id="footerPreview" class="preview-surface"></div>

    <!-- ===== フッター：編集パネル ===== -->
    <div class="edit-grid">
      <div class="field"><label>コピーライト</label><input type="text" id="footer_text" /></div>
      <div class="field"><label>配置</label><select id="footer_alignment"><option>left</option><option>center</option><option>right</option></select></div>
      <div class="field"><label>背景色</label><input type="color" id="footer_bg_color" /></div>
      <div class="field"><label>背景グラデーション</label><input type="text" id="footer_bg_gradient" /></div>
      <div class="field"><label>文字色</label><input type="color" id="footer_text_color" /></div>
      <div class="field"><label>フォント</label><input type="text" id="footer_font_family" /></div>
      <div class="field"><label>文字サイズ(px)</label><input type="number" id="footer_font_size" /></div>
      <div class="field"><label>文字太さ</label><select id="footer_font_weight"><option>normal</option><option>bold</option></select></div>
      <div class="field"><label>リンク間隔(px)</label><input type="number" id="footer_link_spacing" /></div>
      <div class="field"><label>固定表示</label><input type="checkbox" id="footer_fixed" /></div>
      <div class="field col2"><label>パディング</label><input type="text" id="footer_padding" /></div>
    </div>
  </section>

  <!-- ================= メニュー管理 ================= -->
  <section class="panel">
    <div class="panel-head">
      <h3>メニュー管理</h3>
    </div>
    <table id="menuTable"><thead><tr><th>ID</th><th>タイトル</th><th>URL</th><th>Header</th><th>Footer</th></tr></thead><tbody></tbody></table>
  </section>
</div>

<script type="module">
import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm";
const supabase = createClient("https://htnmjsqgoapvuanrsuma.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imh0bm1qc3Fnb2FwdnVhbnJzdW1hIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUzMzI3MDEsImV4cCI6MjA3MDkwODcwMX0.1AACTWZmChfmIIfBad0sf-hLV2bnaUt7bVURXnd0uKA");

async function loadSettings(area){
  let {data,error}=await supabase.from("hf_settings").select("*").eq("area",area).single();
  if(error && error.code==="PGRST116"){ // not found
    await supabase.from("hf_settings").insert({area});
    ({data}=await supabase.from("hf_settings").select("*").eq("area",area).single());
  }
  return data;
}
async function saveSettings(area,values){
  await supabase.from("hf_settings").upsert({...values,area});
}

document.getElementById("saveHeaderBtn").onclick=async()=>{
  const values={
    company_name:document.getElementById("company_name").value,
    logo_url:document.getElementById("logo_url").value,
    logo_height:+document.getElementById("logo_height").value,
    logo_alignment:document.getElementById("logo_alignment").value,
    company_alignment:document.getElementById("company_alignment").value,
    nav_alignment:document.getElementById("nav_alignment").value,
    bg_color:document.getElementById("header_bg_color").value,
    bg_gradient:document.getElementById("header_bg_gradient").value,
    text_color:document.getElementById("header_text_color").value,
    font_family:document.getElementById("header_font_family").value,
    font_size:+document.getElementById("header_font_size").value,
    font_weight:document.getElementById("header_font_weight").value,
    link_spacing:+document.getElementById("header_link_spacing").value,
    padding:document.getElementById("header_padding").value
  };
  await saveSettings("header",values);
};
document.getElementById("saveFooterBtn").onclick=async()=>{
  const values={
    footer_text:document.getElementById("footer_text").value,
    footer_alignment:document.getElementById("footer_alignment").value,
    bg_color:document.getElementById("footer_bg_color").value,
    bg_gradient:document.getElementById("footer_bg_gradient").value,
    text_color:document.getElementById("footer_text_color").value,
    font_family:document.getElementById("footer_font_family").value,
    font_size:+document.getElementById("footer_font_size").value,
    font_weight:document.getElementById("footer_font_weight").value,
    link_spacing:+document.getElementById("footer_link_spacing").value,
    footer_fixed:document.getElementById("footer_fixed").checked,
    padding:document.getElementById("footer_padding").value
  };
  await saveSettings("footer",values);
};
</script>
