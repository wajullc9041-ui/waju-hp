<section id="hf-setting" class="p-6 space-y-10">

  <!-- ヘッダー設定 -->
  <div>
    <h2 class="text-xl font-bold mb-4">ヘッダー設定</h2>
    <form id="header-form" class="space-y-4">
      <!-- ロゴ -->
      <fieldset>
        <legend class="font-semibold">ロゴ</legend>
        <input id="logo_url" type="text" placeholder="ロゴURL" class="input">
        <input id="logo_height" type="text" placeholder="高さ(px)" class="input">
        <select id="logo_alignment" class="input">
          <option value="left">左</option>
          <option value="center">中央</option>
          <option value="right">右</option>
        </select>
      </fieldset>
      <!-- 社名 -->
      <fieldset>
        <legend class="font-semibold">社名</legend>
        <input id="company_name" type="text" placeholder="会社名" class="input">
        <select id="company_alignment" class="input">
          <option value="left">左</option>
          <option value="center">中央</option>
          <option value="right">右</option>
        </select>
        <input id="company_color" type="color" class="input">
        <select id="company_weight" class="input">
          <option value="normal">通常</option>
          <option value="bold">太字</option>
        </select>
        <input id="header_company_size" type="text" placeholder="文字サイズ(px)" class="input">
      </fieldset>
      <!-- ナビ -->
      <fieldset>
        <legend class="font-semibold">ナビ</legend>
        <select id="nav_alignment" class="input">
          <option value="left">左</option>
          <option value="center">中央</option>
          <option value="right">右</option>
        </select>
        <input id="nav_color" type="color" class="input">
        <select id="nav_weight" class="input">
          <option value="normal">通常</option>
          <option value="bold">太字</option>
        </select>
        <input id="header_nav_size" type="text" placeholder="文字サイズ(px)" class="input">
      </fieldset>
      <!-- 全体 -->
      <fieldset>
        <legend class="font-semibold">全体</legend>
        <input id="header_font_family" type="text" placeholder="フォントファミリー" class="input">
        <input id="bar_height_header" type="text" placeholder="高さ(px)" class="input">
        <input id="padding_header" type="text" placeholder="パディング" class="input">
        <input id="link_spacing_header" type="text" placeholder="リンク間隔(px)" class="input">
        <input id="bg_color_header" type="color" class="input">
      </fieldset>
      <button type="button" id="save-header" class="btn">保存</button>
    </form>
    <div id="header-preview" class="mt-6 border p-4 bg-gray-50"></div>
  </div>

  <!-- フッター設定 -->
  <div>
    <h2 class="text-xl font-bold mb-4">フッター設定</h2>
    <form id="footer-form" class="space-y-4">
      <!-- コピーライト -->
      <fieldset>
        <legend class="font-semibold">コピーライト</legend>
        <input id="footer_text" type="text" placeholder="コピーライト" class="input">
        <select id="footer_alignment" class="input">
          <option value="left">左</option>
          <option value="center">中央</option>
          <option value="right">右</option>
        </select>
        <input id="footer_color" type="color" class="input">
        <select id="footer_weight" class="input">
          <option value="normal">通常</option>
          <option value="bold">太字</option>
        </select>
        <input id="footer_copy_size" type="text" placeholder="文字サイズ(px)" class="input">
      </fieldset>
      <!-- ナビ -->
      <fieldset>
        <legend class="font-semibold">ナビ</legend>
        <select id="nav_alignment_footer" class="input">
          <option value="left">左</option>
          <option value="center">中央</option>
          <option value="right">右</option>
        </select>
        <input id="nav_color_footer" type="color" class="input">
        <select id="nav_weight_footer" class="input">
          <option value="normal">通常</option>
          <option value="bold">太字</option>
        </select>
        <input id="footer_nav_size" type="text" placeholder="文字サイズ(px)" class="input">
      </fieldset>
      <!-- 全体 -->
      <fieldset>
        <legend class="font-semibold">全体</legend>
        <input id="footer_font_family" type="text" placeholder="フォントファミリー" class="input">
        <input id="bar_height_footer" type="text" placeholder="高さ(px)" class="input">
        <input id="padding_footer" type="text" placeholder="パディング" class="input">
        <input id="link_spacing_footer" type="text" placeholder="リンク間隔(px)" class="input">
        <input id="bg_color_footer" type="color" class="input">
      </fieldset>
      <button type="button" id="save-footer" class="btn">保存</button>
    </form>
    <div id="footer-preview" class="mt-6 border p-4 bg-gray-50"></div>
  </div>
</section>

<script type="module">
import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm";
const supabaseUrl = "https://htnmjsqgoapvuanrsuma.supabase.co";
const supabaseKey = "YOUR_SUPABASE_ANON_KEY";
const sb = createClient(supabaseUrl, supabaseKey);

// 値をまとめる関数
function getHeader(){
  return {
    logo_url: document.getElementById("logo_url").value,
    logo_height: document.getElementById("logo_height").value,
    logo_alignment: document.getElementById("logo_alignment").value,
    company_name: document.getElementById("company_name").value,
    company_alignment: document.getElementById("company_alignment").value,
    company_color: document.getElementById("company_color").value,
    company_weight: document.getElementById("company_weight").value,
    header_company_size: document.getElementById("header_company_size").value,
    nav_alignment: document.getElementById("nav_alignment").value,
    nav_color: document.getElementById("nav_color").value,
    nav_weight: document.getElementById("nav_weight").value,
    header_nav_size: document.getElementById("header_nav_size").value,
    header_font_family: document.getElementById("header_font_family").value,
    bar_height_header: document.getElementById("bar_height_header").value,
    padding_header: document.getElementById("padding_header").value,
    link_spacing_header: document.getElementById("link_spacing_header").value,
    bg_color_header: document.getElementById("bg_color_header").value,
  };
}
function getFooter(){
  return {
    footer_text: document.getElementById("footer_text").value,
    footer_alignment: document.getElementById("footer_alignment").value,
    footer_color: document.getElementById("footer_color").value,
    footer_weight: document.getElementById("footer_weight").value,
    footer_copy_size: document.getElementById("footer_copy_size").value,
    nav_alignment_footer: document.getElementById("nav_alignment_footer").value,
    nav_color_footer: document.getElementById("nav_color_footer").value,
    nav_weight_footer: document.getElementById("nav_weight_footer").value,
    footer_nav_size: document.getElementById("footer_nav_size").value,
    footer_font_family: document.getElementById("footer_font_family").value,
    bar_height_footer: document.getElementById("bar_height_footer").value,
    padding_footer: document.getElementById("padding_footer").value,
    link_spacing_footer: document.getElementById("link_spacing_footer").value,
    bg_color_footer: document.getElementById("bg_color_footer").value,
  };
}

// 保存
document.getElementById("save-header").onclick = async () => {
  const payload = getHeader();
  const { data, error } = await sb.from("hf_settings")
    .update({ data: payload })
    .eq("area", "header")
    .select();
  console.log("payload:", payload);
  console.log("save-header result:", data, error);
};
document.getElementById("save-footer").onclick = async () => {
  const payload = getFooter();
  await sb.from("hf_settings").update({ data: payload }).eq("area","footer");
  document.getElementById("footer-preview").innerText = JSON.stringify(payload, null, 2);
};

// 初期ロード
async function loadHF(){
  const headerRow = await sb.from("hf_settings").select("data").eq("area","header").single();
  const footerRow = await sb.from("hf_settings").select("data").eq("area","footer").single();
  if(headerRow.data?.data){
    Object.entries(headerRow.data.data).forEach(([key,val])=>{
      const el = document.getElementById(key);
      if(el) el.value = val;
    });
    document.getElementById("header-preview").innerText = JSON.stringify(headerRow.data.data, null, 2);
  }
  if(footerRow.data?.data){
    Object.entries(footerRow.data.data).forEach(([key,val])=>{
      const el = document.getElementById(key);
      if(el) el.value = val;
    });
    document.getElementById("footer-preview").innerText = JSON.stringify(footerRow.data.data, null, 2);
  }
}
loadHF();
</script>
